<html>
<head>
<!-- Meta Tags for mobile -->
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />  
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="true">
<meta name="MobileOptimized" content="width">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
$(document).ready(function(){

	$("#submitWebsite").on("click",function(e){
		e.preventDefault();
		var accountName = $("#account").val();
		$.ajax({
			type:"POST",
			url:"rest/login/account",
			data:{
				accountName:accountName
			},
			success:function(token){
				if(localStorage){
					localStorage.setItem('token',token );
					//if(/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase()))
					window.location.replace(window.location.pathname+"page.html");
				}else{
					alert("Use a normal browser! Localstorage is not available")
				}
			}
		})
	});
	$(".applogin #submitApp").on("click",function(e){
		e.preventDefault();
		var userName = $(".applogin #userName").val();
		var pass = $(".applogin #password").val();
		$.ajax({
			type:"POST",
			url:"rest/login/user",
			data:{
				userName:userName,
				password:pass
			},
			success:function(token){
				if(localStorage){
					localStorage.setItem('token',token );
					window.location.replace(window.location.pathname+"app.html");
				}else{
					alert("Use a normal browser! Localstorage is not available")
				}
			}
		})
	})
	$("#registerUser").on("click",function(e){
		e.preventDefault();
		var userName = $("#userName").val();
		var pass = $("#password").val();
		var data = {};
		$.each(".registerItem",function(ind,item){
			data[$(item).attr("name")] =$(item).val(); 
		});
		$.ajax({
			type:"POST",
			url:"rest/register/user",
			data:{
				userName:userName,
				password:pass
			},
			success:function(token){
				if(localStorage){
					//localStorage.setItem('token',token );
					//window.location.replace(window.location.pathname+"app.html");
				}else{
					alert("Use a normal browser! Localstorage is not available")
				}
			}
		})
	});
	
$("#uploadImage").on("click",function(e){
	e.preventDefault();
	var formData = new FormData ($("#imageForm")[0]);
	formData.append("token",localStorage.getItem("token"));
	$.ajax({
	    url: 'rest/image/user',
	    data: formData,
	    cache: false,
	    contentType: false,
	    processData: false,
	    type: 'POST',
	    success: function(data){
	        alert("Image uploaded");
	    }
	});
})
})


</script>

</head>
<body>

 <div class="websitelogin"><p>Gruppe:<br><input id="account" name="account" type="text" size="30" maxlength="30" value="account-1"></p>
<input id ="submitWebsite" type="submit" value="Anmelden">
</div>
<hr/>
<div class="applogin">
<p>User:<br /><input id="userName" name="userName" type="text" size="30" maxlength="30" value=""></p>
<p>Pass:<br /><input id="password" name="password" type="password" size="30" maxlength="30" value=""></p>

<input id ="submitApp" type="submit" value="Anmelden">
</div>
<hr />
<div class="register">

<p>Name:<br /><input class="registerItem" id="rUserName" name="userName" type="text" size="30" maxlength="30" value=""></p>
<p>Pass:<br /><input class="registerItem" id="rPassword" name="password" type="text" size="30" maxlength="30" value=""></p>
<p>Gender:<br />
 <select class="registerItem" name="rGender" size="1">
      <option>m</option>
      <option>w</option>
    </select>
</p>
<p>Weight:<br /><input class="registerItem" id="rWeight" name="userWeight" type="text" size="30" maxlength="30" value=""></p>
<p>Gruppe:<br /><input class="registerItem" id="rAccount" name="account" type="text" size="30" maxlength="30" value=""></p>

<input id ="registerUser" type="submit" value="Registrieren">
</div>
<hr/>
<form id="imageForm">
<p>Image:<br /><input class="registerItem" id="rImage" name="image" type="file"></p>
<input id ="uploadImage" type="submit" value="ImageUpload">
</form>
</body>
</html>