<!DOCTYPE html>
<html>
<head>
<!-- Meta Tags for mobile -->
   <meta charset="utf-8">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />  
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

 <script src="../libs/jquery/jquery-1.8.1.js"></script> 
  <script src="../libs/bootstrap/js/bootstrap.min.js"></script> 
  <script src="../libs/ICanHaz.min.js"></script> 
  <script>
  //Init Namespace
  var ZMO = ZMO || {};
  ZMO.Util = ZMO.Util ||{};
  ZMO.modules = ZMO.modules ||{};
  </script>
  
    <script src="../js/Modules/Constants.js"></script> 
      <script src="../js/Modules/Model.js"></script>    
     
  <script src="../js/Util/UtilConstants.js"></script>   
     <script src="../js/Util/Object/Exists.js"></script>   
     <script src="../js/Util/Browser/Scroller.js"></script> 
  <script src="../js/Util/Net/Ajax.js"></script>   
  <script src="../libs/datefunctions/date.js"></script>     
  <script src="../js/Util/Date/TimeParser.js"></script>   
    <script src="../js/Modules/Model.js"></script>   
 <link rel="stylesheet" type="text/css" href="../libs/bootstrap/css/bootstrap.min.css" />
 
 <link rel="stylesheet" type="text/css" href="../libs/bootstrap/css/bootstrap-responsive.min.css" />

 <link rel="stylesheet" type="text/css" href="css/style.css" />  
  <script src="../libs/jqplot/jquery.jqplot.min.js" type="text/javascript"></script>
   <script>
 var baseUrl = "../";
 var ajax = ZMO.Util.Net.Ajax;
 ZMO.exists = ZMO.Util.Object.exists;
 ZMO.Constants =ZMO.UtilConstants;
 var defaultImg = "../images/view/pix.png";
 ZMO.logger = (function(){
	  	var log = function(str){
	  		if(console && ZMO.Constants.debugMode){
	  	
	  		console.log(str);
	  		}
	  	};
	  	var warning = function(str){
	  		if(console && ZMO.Constants.debugMode){
	  	
	  		console.log(str);
	  		}
	  	};
	  	var error = function(str){
	  		if(console && ZMO.Constants.debugMode){
	  			
	  			console.log(str);
	  			}
	  	}
	  	var pub = {
	  			log:log,
	  			warning:warning,
	  			error:error
	  	};
	  	return pub;
	  })();

 </script>
  <script id="dashboard-zapfliste-row" type="text/html">

<tr data-drawid="{{drawId}}" data-boxid="{{boxId}}" data-userid="{{userId}}" data-userimage="{{userImage}}{{image}}" data-username="{{userName}}">
  <td><img class="img-rounded" src="{{userImage}}{{image}}" width="32" height="32"/></td>
  <td>{{userName}}</td>
   <td class="amountCol">{{amount}} l</td>
</tr>
</script>
<script>
var baseUrl = "../";
var chart;
$(document).ready(function(){
	/**
	 * Zapfliste
	 */
	 var LENGTH=30;
	function loadListItems(start,len,callback,prepend){
		
		ajax.getDatas("rest/drawings",function(data){
		//ajax.getDatas("rest/news",function(data){
			
			var container = $("#zapfliste");
					$.each(data,function(ind,news){
						//if(news.type.toLowerCase()=="drawing"){
							news=	new ZMO.NewsModel(news);	
							var template =$(ich["dashboard-zapfliste-row"](news));
							if(prepend){
								container.prepend(template);
							}else{
								container.append(template);
							}
						//}
					});
					if(callback)callback();
			},{
				start:start,
				length:len
		});
	}
	var counter = 0;
	var addedNews = 0;
	 ZMO.Util.scrollHandler.bindScrollHandler(function(loadingFinished){
			//console.log("tes");
			counter++;
			loadListItems(counter*LENGTH+addedNews,LENGTH,loadingFinished);
			
		
	 });
	 $('#zapfliste').on("click","tr",function(e) {
		 var el = $(e.currentTarget);
			//alert(el.data("drawid"));
			getPlotDatas(el.data("drawid"));
	 });
	 loadListItems(0,LENGTH);
	/**
	 * Chart
	 */
	
	var plotOptions = {
			 grid: {
	        	    drawGridLines: true,        // wether to draw lines across
												// the grid or not.
	        	        gridLineColor: 'rgba(255,255,255,0.3)',   // CSS color
																	// spec of
																	// the grid
																	// lines.
	        	        background: 'rgba(255,255,255,0)',      // CSS color
																// spec for
																// background
																// color of
																// grid.
	        	        borderColor: 'rgba(255,255,255,0)',     // CSS color
																// spec for
																// border around
																// grid.
	        	        borderWidth: 2.0,           // pixel width of border
													// around grid.
	        	        shadow: true,               // draw a shadow for grid.
	        	        shadowAngle: 45,            // angle of the shadow.
													// Clockwise from x axis.
	        	        shadowOffset: 1.5,          // offset from the line of
													// the shadow.
	        	        shadowWidth: 3,             // width of the stroke for
													// the shadow.
	        	        shadowDepth: 3
	        	}, 
	        	seriesColors: ["#dddf0d","#90b1d8",  "#c5b47f", "#EAA228", "#579575", "#839557", "#958c12",
	        	                 "#953579", "#4b5de4", "#d8b83f", "#ff5800", "#0085cc"],
	};
	
	function plotData(id,datas){
		if(chart){
			chart.destroy();
		}
		chart = $.jqplot(id, datas);
	}
	
	function getPlotDatas(drawId){
		ajax.getDatas("rest/drawings/"+drawId+"/ticks",function(data){
				var arr = [];
				arr[0] = [];
				//arr[1] = [];
				$.each(data,function(ind,val){
					arr[0].push(val.ticks);
					//arr[1].push(val.ticks);
				});
				
				plotData("linechart",arr);
			})
	};
	
	



});


</script>

</head>
<body>
<!-- Include Navigation -->
<div id="navigation"></div>
<script>
var navigation = $("#navigation").load("header.html",function(){
	//navigation.find(".kegchange").addClass("active");	
});
</script>
<div class="container">
 <div class="row" style="margin-top:50px">
<div class="well span4">
	<table id="" class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Bild</th>
      <th>Name</th>
      <th>Menge</th>
    </tr>
  </thead>
  <tbody id="zapfliste">
   
  </tbody>
</table>
	
</div>
<div class="navbar span7">
  <div class="navbar-inner">
  	<div id="linechart"></div>
  	</div>
</div>
</div>
</div>
</body>
</html>